{"ast":null,"code":"function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport CodeBlock from '@/components/markdown/components/code-block';\nimport Heading from '@/components/markdown/components/heading';\nimport React, { useReducer } from 'react';\nimport Article from '@/components/markdown/components/article';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\n\nconst BuildFailureDetails = (_ref) => {\n  let {\n    ciJob,\n    repoVersionInfo,\n    editorVersionInfo,\n    ciBuild\n  } = _ref,\n      rest = _objectWithoutProperties(_ref, [\"ciJob\", \"repoVersionInfo\", \"editorVersionInfo\", \"ciBuild\"]);\n\n  const {\n    editorVersion,\n    baseOs,\n    targetPlatform\n  } = ciBuild.buildInfo;\n  const {\n    major,\n    minor,\n    patch\n  } = repoVersionInfo;\n\n  const reducer = (state, action) => {\n    const {\n      tag,\n      value\n    } = action;\n    return _objectSpread(_objectSpread({}, state), {}, {\n      [tag]: value\n    });\n  };\n\n  const {\n    0: tags\n    /* , dispatch */\n\n  } = useReducer(reducer, {\n    [`${baseOs}-${editorVersion}-${targetPlatform}-${major}`]: '❓',\n    [`${baseOs}-${editorVersion}-${targetPlatform}-${major}.${minor}`]: '❓',\n    [`${baseOs}-${editorVersion}-${targetPlatform}-${major}.${minor}.${patch}`]: '❓',\n    [`${editorVersion}-${targetPlatform}-${major}`]: '❓',\n    [`${editorVersion}-${targetPlatform}-${major}.${minor}`]: '❓',\n    [`${editorVersion}-${targetPlatform}-${major}.${minor}.${patch}`]: '❓'\n  }); // Todo - fetch docker info from dockerhub for all tags, or do it on the server\n  // useEffect(() => {\n  //   (async () => {\n  //     const repo = 'unityci/editor';\n  //     for (const tag of Object.keys(tags)) {\n  //       const requestUrl = `https://index.docker.io/v1/repositories/${repo}/tags/${tag}`;\n  //       try {\n  //         const response = await fetch(requestUrl);\n  //         dispatch({ tag, value: response.status === 0 });\n  //       } catch (error) {\n  //         dispatch({ tag, value: false });\n  //       }\n  //     }\n  //   })();\n  // }, []);\n\n  const {\n    changeSet\n  } = editorVersionInfo;\n  const command = `docker build . --file ./editor/Dockerfile -t editor ` + `--build-arg=version=${editorVersion} ` + `--build-arg=changeSet=${changeSet} ` + `--build-arg=module=${targetPlatform}`;\n  return /*#__PURE__*/_jsxs(Article, _objectSpread(_objectSpread({}, rest), {}, {\n    children: [/*#__PURE__*/_jsx(Heading, {\n      level: 4,\n      children: \"CI Job\"\n    }), /*#__PURE__*/_jsx(\"pre\", {\n      children: JSON.stringify(ciJob, null, 2)\n    }), /*#__PURE__*/_jsx(\"br\", {}), /*#__PURE__*/_jsx(Heading, {\n      level: 4,\n      children: \"Commands\"\n    }), /*#__PURE__*/_jsx(\"p\", {\n      children: \"To manually build for debugging:\"\n    }), /*#__PURE__*/_jsx(CodeBlock, {\n      language: \"powershell\",\n      children: [command]\n    }), /*#__PURE__*/_jsx(\"br\", {}), /*#__PURE__*/_jsx(Heading, {\n      level: 3,\n      children: \"Associated tags\"\n    }), /*#__PURE__*/_jsx(\"pre\", {\n      children: JSON.stringify(tags, null, 2)\n    }), /*#__PURE__*/_jsx(\"br\", {}), /*#__PURE__*/_jsx(Heading, {\n      level: 4,\n      children: \"CI Build\"\n    }), /*#__PURE__*/_jsx(\"pre\", {\n      children: JSON.stringify(ciBuild, null, 2)\n    })]\n  }));\n};\n\nexport default BuildFailureDetails;","map":null,"metadata":{},"sourceType":"module"}